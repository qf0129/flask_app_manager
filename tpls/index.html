<!DOCTYPE html>
<html>
<head>
    <title>Index</title>
</head>
<body>
<button class="add_app_btn">add</button>
<div class="configs_div"></div>

<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
        $.ajax({
            url:"/configs",
            type:'GET',
            cache:false,
            processData:false,
            contentType:false,
            dataType: 'json',
            success:function(Data){
                if (Data.code==0){
                    for (var i=0;i<Data.apps.length;i++){
                        var app = Data.apps[i];
                        var app_div = $('<div class="app_div"></div>');
                        $('.configs_div').append(app_div);
                        app_div.append('<span>'+app.name+'</span>')
                        app_div.append('<span>  |  </span>')
                        app_div.append('<span>'+app.status+'</span>')
                        app_div.append('<span>  |  </span>')
                        if(app.status=='stopped'){
                            app_div.append('<button onclick="change_status(\''+app.name+'\', \'run\')">run</button>')
                        }else if(app.status=='running'){
                            app_div.append('<button onclick="change_status(\''+app.name+'\', \'stop\')">stop</button>')
                        }
                    }
                }else{
                    alert(Data.msg);
                }
            },
            error:function(){
                stop_listen();
                alert("error");
            }
        });

        function change_status(config_name, config_status){
            $.ajax({
                url:"/config_status",
                type:'POST',
                data:{config_name:config_name, config_status:config_status},
                cache:false,
                dataType: 'json',
                success:function(Data){
                    if (Data.code==0){
                        location.reload();
                    }else{
                        alert(Data.code);
                    }
                },
                error:function(){
                    alert("error");
                }
            });
        }
</script>
</body>
</html>